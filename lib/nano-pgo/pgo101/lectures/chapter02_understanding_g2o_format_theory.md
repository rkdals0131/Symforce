
# PGO 101 - Chapter 2 이론 강의: SLAM 데이터의 표준어, g2o 포맷

**강의 목표:** 이 강의를 마치면, 여러분은 SLAM 커뮤니티에서 표준처럼 사용되는 `g2o` 파일 포맷의 구조를 완벽하게 이해하게 됩니다. `VERTEX`와 `EDGE`가 각각 무엇을 의미하는지, 그리고 측정의 신뢰도를 나타내는 `Information Matrix`가 최적화에 어떤 영향을 미치는지 설명할 수 있게 됩니다. 이 강의는 `chapter02_understanding_g2o_format.ipynb` 실습에서 실제 데이터셋을 파싱하고 분석하기 위한 필수적인 사전 지식을 제공합니다.

---

## 1. 왜 SLAM 문제를 그래프로 표현할까?

SLAM(Simultaneous Localization and Mapping)은 본질적으로 거대한 '퍼즐 맞추기'와 같습니다. 로봇이 움직이면서 얻는 수많은 불확실한 측정값(퍼즐 조각)들을 모아, 가장 모순이 없는 하나의 일관된 지도(완성된 퍼즐)를 만드는 과정입니다.

이 복잡한 관계를 표현하기에 가장 적합한 자료구조가 바로 **그래프(Graph)**입니다.

*   **정점 (Vertex)**: 그래프의 '점'. SLAM에서는 로봇의 특정 시점에서의 **자세(Pose)**를 나타냅니다.
*   **간선 (Edge)**: 두 정점을 잇는 '선'. SLAM에서는 두 자세 사이의 **상대적인 움직임 측정값(Relative Measurement)**, 즉 제약 조건(Constraint)을 나타냅니다.

> 💡 **핵심 비유**: 여러분이 눈을 가리고 방 안을 돌아다닌다고 상상해보세요.
> - **정점**: "한 걸음 앞으로 간 뒤의 내 위치와 방향", "오른쪽으로 90도 돈 뒤의 내 위치와 방향" ...
> - **간선**: "방금 전 위치에서 지금 위치까지는 대략 한 걸음 직진했어" 라는 측정값.
>
> 나중에 벽을 더듬다가 출발했던 지점으로 돌아왔다는 것을 깨닫는 순간(**루프 클로저, Loop Closure**), 여러분은 머릿속에서 전체 경로에 대한 그림을 수정하여 모순을 해결합니다. 그래프 최적화도 정확히 이와 같은 원리로 동작합니다.

## 2. g2o 포맷: 그래프를 파일로 저장하는 약속

`g2o`는 이렇게 그래프로 표현된 SLAM 문제를 텍스트 파일로 저장하고 불러오기 위한 **표준 형식(Standard Format)**입니다. 다양한 SLAM 라이브러리(GTSAM, Ceres 등)가 이 포맷을 지원하기 때문에, SLAM 연구와 개발에서 '공용어'처럼 사용됩��다.

### 개념 트리: g2o 파일 구조

*   **g2o 파일**
    *   **`VERTEX_SE2` / `VERTEX_SE3:QUAT`**: 정점(포즈) 정보
        *   **`id`**: 각 포즈의 고유한 식별 번호.
        *   **`x, y, (z)`**: 월드 좌표계 기준의 위치.
        *   **`theta` 또는 `qx, qy, qz, qw`**: 월드 좌표계 기준의 방향.
    *   **`EDGE_SE2` / `EDGE_SE3:QUAT`**: 간선(상대 변환) 정보
        *   **`id1, id2`**: 연결되는 두 포즈의 ID.
        *   **`dx, dy, (dz), ...`**: 포즈 `id1`에서 `id2`로의 상대적인 움직임 측정값.
        *   **`Information Matrix`**: 이 측정값이 얼마나 신뢰할 수 있는지를 나타내는 행렬.

### [실습 연결]
`chapter02` 노트북의 **2. g2o 파서 구현** 섹션에서는, 지금 배운 구조를 바탕으로 `.g2o` 텍스트 파일을 한 줄씩 읽어, 파이썬의 딕셔너리(poses)와 리스트(edges) 자료구조로 변환하는 파서를 직접 구현합니다.

---

## 3. 정보 행렬(Information Matrix): 측정의 신뢰도를 정량화하다

모든 센서 측정에는 노이즈가 포함되어 있으며, 그 신뢰도 또한 다릅니다. 예를 들어, 고정밀 레이저 스캐너의 측정값은 로봇 바퀴의 회전수로 계산한 오도메트리보다 훨씬 신뢰할 수 있습니다. **정보 행렬($\Omega$)**은 이러�� 측정의 신뢰도를 수학적으로 표현한 것입니다.

*   **정의**: 불확실성을 나타내는 **공분산 행렬(Covariance Matrix, $\Sigma$)의 역행렬**입니다. ($\Omega = \Sigma^{-1}$)
*   **직관적 의미**:
    *   **공분산이 크다** = 불확실성이 크다 = **정보량이 적다**.
    *   **공분산이 작다** = 불확실성이 작다 = **정보량이 많다**.
*   **행렬 값의 의미**:
    *   **대각 원소**: 각 차원(x, y, z, roll, pitch, yaw)의 정보량을 나타냅니다. 이 값이 클수록 해당 차원의 측정이 정확하다는 의미입니다.
    *   **비대각 원소**: 차원 간의 상관관계를 나타냅니다.

최적화 알고리즘은 이 정보 행렬을 **가중치(weight)**로 사용합니다. 즉, 정보 행렬의 값이 큰(신뢰도 높은) 엣지의 오차를 줄이는 데 더 많은 노력을 기울입니다.

> 💡 **핵심 비유**: 여러 명의 목격자(측정값) 진술을 바탕으로 사건을 재구성하는 탐정을 상상해보세요. 탐정은 신뢰도가 높은 목격자(정보 행렬 값이 큰 엣지)의 진술에 더 큰 비중을 두고 결론을 내릴 것입니다.

### [실습 연결]
`chapter02` 노트북의 **6. Information Matrix 분석** 섹션에서는 실제 데이터셋의 정보 행렬을 시각화하고, 그 조건수(Condition Number)를 분석하여 측정의 '건강 상태'를 평가하는 방법을 배웁니다.
