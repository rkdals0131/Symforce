# PGO 101 - Chapter 6 μ΄λ΅  κ°•μ: ν„μ‹¤μ λ…Έμ΄μ¦μ™€ μ‹Έμ°κΈ° - κ°•μΈν• μµμ ν™”

**κ°•μ λ©ν‘:** μ΄ κ°•μλ¥Ό λ§μΉλ©΄, μ—¬λ¬λ¶„μ€ μ‹¤μ  SLAM μƒν™©μ—μ„ μ™ ν‘μ¤€ μµμ† μ κ³±λ²•μ΄ μ‹¤ν¨ν•  μ μλ”μ§€, κ·Έλ¦¬κ³  **μ΄μƒμΉ (Outlier)** λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν• **κ°•μΈν• μµμ ν™” (Robust Optimization)** κΈ°λ²•μ΄ μ™ ν•„μμ μΈμ§€ μ΄ν•΄ν•κ² λ©λ‹λ‹¤. λ‹¤μ–‘ν• κ°•μΈν• λΉ„μ© ν•¨μ (Robust Kernel) μ μ›λ¦¬λ¥Ό λ°°μ°κ³ , μ΄λ¥Ό **λ°λ³µμ  μ¬κ°€μ¤‘ μµμ† μ κ³±λ²• (IRLS)** μ„ ν†µν•΄ κµ¬ν„ν•λ” λ°©λ²•μ„ μ„¤λ…ν•  μ μκ² λ©λ‹λ‹¤. μ΄ κ°•μλ” `chapter06_robust_optimization_with_cauchy.ipynb` μ‹¤μµμ—μ„ μ΄μƒμΉμ— κ°•κ±΄ν• μµν‹°λ§μ΄μ €λ¥Ό κµ¬ν„ν•κΈ° μ„ν• μ΄λ΅ μ  κΈ°λ°μ„ μ κ³µν•©λ‹λ‹¤.

---

## 1. ν‘μ¤€ μµμ† μ κ³±λ²•μ ν•¨μ •: μ΄μƒμΉ (Outlier) λ¬Έμ 

μ§€κΈκΉμ§€ μ°λ¦¬λ” λΉ„μ© ν•¨μλ¥Ό μ¤μ°¨μ **μ κ³±**μ ν•© ($\sum \mathbf{e}^T \Omega \mathbf{e}$) μΌλ΅ μ •μν–μµλ‹λ‹¤. μ΄ λ°©λ²•μ€ μ¤μ°¨ λ¶„ν¬κ°€ κ°€μ°μ‹μ• (Gaussian) μ •κ·λ¶„ν¬λ¥Ό λ”°λ¥Ό λ• ν†µκ³„μ μΌλ΅ μµμ μ ν•΄λ¥Ό μ κ³µν•©λ‹λ‹¤.

ν•μ§€λ§ ν„μ‹¤ μ„Έκ³„μ μ„Όμ„ λ°μ΄ν„°λ” ν•­μƒ μ •κ·λ¶„ν¬λ¥Ό λ”°λ¥΄μ§€ μ•μµλ‹λ‹¤. λ•λ΅λ” μμƒμΉ λ»ν• **μ•„μ£Ό ν° μ¤μ°¨**, μ¦‰ **μ΄μƒμΉ (Outlier)** κ°€ λ°μƒν•©λ‹λ‹¤.

*   **SLAMμ—μ„μ μ΄μƒμΉ λ°μƒ μ›μΈ**:
    *   **μλ»λ λ£¨ν”„ ν΄λ΅μ €**: λΉ„μ·ν•κ² μƒκΈ΄ λ‹¤λ¥Έ μ¥μ†λ¥Ό κ°™μ€ μ¥μ†λ΅ μ°©κ°. (κ°€μ¥ μΉλ…μ !)
    *   **μ„Όμ„ μ¤λ¥**: ν–‡λΉ› λ°μ‚¬, μΌμ‹μ μΈ μ„Όμ„ κ³ μ¥.
    *   **λ™μ  κ°μ²΄**: μ›€μ§μ΄λ” μ‚¬λμ΄λ‚ μ°¨λ¥Ό κ³ μ •λ λλ“λ§ν¬λ΅ μ¤μΈ.
    *   **λ°μ΄ν„° μ—°κ΄€ μ‹¤ν¨**: νΉμ§•μ  (feature) μ„ μλ» λ§¤μΉ­.

**λ¬Έμ μ **: ν‘μ¤€ μµμ† μ κ³±λ²•μ€ μ¤μ°¨λ¥Ό **μ κ³±**ν•κΈ° λ•λ¬Έμ—, μ‘μ€ μ¤μ°¨λ” λ” μ‘μ•„μ§€μ§€λ§ **ν° μ¤μ°¨λ” ν›¨μ”¬ λ” μ»¤μ§‘λ‹λ‹¤.**

> π’΅ **ν•µμ‹¬ λΉ„μ **: 10λ…μ λ° ν•™μƒλ“¤μ ν‰κ·  ν‚¤λ¥Ό μ¬λ”λ°, ν• λ…μ ν‚¤λ¥Ό μ‹¤μλ΅ 200cmκ°€ μ•„λ‹ 2000cmλ΅ μ…λ ¥ν–λ‹¤κ³  μƒμƒν•΄λ³΄μ„Έμ”. μ΄ λ‹¨ ν•λ‚μ μ΄μƒμΉ λ•λ¬Έμ— λ° ν‰κ·  ν‚¤λ” λΉ„ν„μ‹¤μ μΌλ΅ μ»¤μ Έ λ²„λ¦½λ‹λ‹¤. ν‘μ¤€ μµμ† μ κ³±λ²•μ€ μ΄μ™€ κ°™μ΄ μ΄μƒμΉμ— μν•΄ μ „μ²΄ κ²°κ³Όκ°€ ν¬κ² μ™κ³΅λλ” λ¬Έμ μ— λ§¤μ° μ·¨μ•½ν•©λ‹λ‹¤.

## 2. κ°•μΈν• λΉ„μ© ν•¨μ (Robust Kernel): μ΄μƒμΉμ μν–¥λ ¥ μ¤„μ΄κΈ°

μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄, μ¤μ°¨μ ν¬κΈ°μ— λ”°λΌ κ·Έ μν–¥λ ¥μ„ λ™μ μΌλ΅ μ΅°μ ν•λ” **κ°•μΈν• λΉ„μ© ν•¨μ (Robust Kernel λλ” Robust Loss Function)** λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

ν•µμ‹¬ μ•„μ΄λ””μ–΄λ” κ°„λ‹¨ν•©λ‹λ‹¤. **"μ¤μ°¨κ°€ μΌοΏ½οΏ½ μμ¤€μ„ λ„μ–΄κ°€λ©΄, κ·Έ μν–¥λ ¥μ„ λ” μ΄μƒ μ κ³±μΌλ΅ μ¦κ°€μ‹ν‚¤μ§€ μ•κ±°λ‚, μ¤νλ ¤ μ¤„μ—¬λ²„λ¦¬μ!"**

μν•™μ μΌλ΅, λΉ„μ© ν•¨μλ¥Ό λ‹¤μκ³Ό κ°™μ΄ μμ •ν•©λ‹λ‹¤.

$$ F(\mathbf{x}) = \sum_{(i,j) \in \mathcal{C}} \rho \left( \sqrt{\mathbf{e}_{ij}^T \Omega_{ij} \mathbf{e}_{ij}} \right) $$

μ—¬κΈ°μ„ $\rho(\cdot)$ κ°€ λ°”λ΅ κ°•μΈν• λΉ„μ© ν•¨μμ…λ‹λ‹¤.

### μ£Όμ” κ°•μΈν• λΉ„μ© ν•¨μ

*   **L2 Loss (ν‘μ¤€)**: $\rho(e) = \frac{1}{2}e^2$. κ°•μΈν•μ§€ μ•μ.
*   **Huber Loss**:
    -   **λ™μ‘**: μ‘μ€ μ¤μ°¨λ” L2μ²λΌ, ν° μ¤μ°¨λ” L1 (μ„ ν• μ¦κ°€) μ²λΌ λ™μ‘.
    -   **νΉμ§•**: μ΄μƒμΉμ μν–¥λ ¥μ„ λ¶€λ“λ½κ² μ ν•ν•λ” 'μ¤‘μ¬μ' μ—­ν• .
*   **Cauchy (μ½”μ‹) Loss**:
    -   **λ™μ‘**: Huberλ³΄λ‹¤ λ” κ³µκ²©μ μΌλ΅ ν° μ¤μ°¨μ μν–¥λ ¥μ„ μ¤„μ„.
    -   **νΉμ§•**: μ΄μƒμΉλ¥Ό μ™„μ „ν λ¬΄μ‹ν•μ§€λ” μ•μ§€λ§, κ·Έ μν–¥λ ¥μ„ λ§¤μ° μ‘κ² λ§λ“λ” 'κ΄€μ©μ μΈ' μ—­ν• .
*   **Tukey Loss**:
    -   **λ™μ‘**: νΉμ • μ„κ³„κ°’μ„ λ„λ” μ¤μ°¨λ” **μ™„μ „ν λ¬΄μ‹ (μν–¥λ ¥ = 0)**.
    -   **νΉμ§•**: κ°€μ¥ κ³µκ²©μ μΌλ΅ μ΄μƒμΉλ¥Ό μ κ±°ν•λ” 'μ—„κ²©ν• μ‹¬ν' μ—­ν• .

### [μ‹¤μµ μ—°κ²°]
`chapter06` λ…ΈνΈλ¶μ **2. Robust Loss Functions** μ™€ **3. Visualizing Robust Kernels** μ„Ήμ…μ—μ„λ”, μ΄ μ»¤λ„λ“¤μ μμ‹μ„ μ§μ ‘ μ½”λ“οΏ½οΏ½οΏ½ κµ¬ν„ν•κ³ , κ° ν•¨μμ λ¨μ–‘κ³Ό κ°€μ¤‘μΉ λ³€ν™”λ¥Ό μ‹κ°ν™”ν•μ—¬ κ·Έ λ™μ‘ μ›λ¦¬λ¥Ό μ§κ΄€μ μΌλ΅ λΉ„κµν•©λ‹λ‹¤.

---

## 3. λ°λ³µμ  μ¬κ°€μ¤‘ μµμ† μ κ³±λ²• (IRLS): κ°•μΈν• μµμ ν™” κµ¬ν„ν•κΈ°

κ·Έλ ‡λ‹¤λ©΄ μ΄ κ°•μΈν• λΉ„μ© ν•¨μλ¥Ό μ–΄λ–»κ² μµμ ν™”μ— μ μ©ν• κΉμ”? **λ°λ³µμ  μ¬κ°€μ¤‘ μµμ† μ κ³±λ²• (Iteratively Reweighted Least Squares, IRLS)** μ΄λΌλ” μλ¦¬ν• λ°©λ²•μ„ μ‚¬μ©ν•©λ‹λ‹¤.

IRLSλ” κ°•μΈν• μµμ ν™” λ¬Έμ λ¥Ό, λ§¤ λ°λ³µλ§λ‹¤ **κ°€μ¤‘μΉκ°€ λ‹¬λΌμ§€λ”** ν‘μ¤€ μµμ† μ κ³± λ¬Έμ λ΅ λ³€ν™ν•μ—¬ ν’‰λ‹λ‹¤.

1.  **μ¤μ°¨ κ³„μ‚°**: ν„μ¬ μ¶”μ •μΉλ¥Ό κΈ°μ¤€μΌλ΅ λ¨λ“  μΈ΅μ •κ°’μ μ¤μ°¨ ($\mathbf{e}_{ij}$) λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
2.  **κ°€μ¤‘μΉ κ³„μ‚°**: κ° μ¤μ°¨μ ν¬κΈ°λ¥Ό κ°•μΈν• λΉ„μ© ν•¨μ (μ: Cauchy μ»¤λ„) μ— λ„£μ–΄ **κ°€μ¤‘μΉ ($w_i$)** λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
    *   μ¤μ°¨κ°€ μ‘μΌλ©΄ -> κ°€μ¤‘μΉκ°€ 1μ— κ°€κΉμ›€.
    *   μ¤μ°¨κ°€ ν¬λ©΄ (μ΄μƒμΉ) -> κ°€μ¤‘μΉκ°€ 0μ— κ°€κΉμ›μ§.
3.  **κ°€μ¤‘ μµμ† μ κ³± λ¬Έμ  ν’€μ΄**: μ΄ κ°€μ¤‘μΉλ¥Ό μ›λμ μ •λ³΄ ν–‰λ ¬ ($\Omega$) μ— κ³±ν•μ—¬ ($\Omega' = w \cdot \Omega$), κ°€μ¤‘μΉκ°€ μ μ©λ μƒλ΅μ΄ μ„ ν• μ‹μ¤ν… $H' \Delta \mathbf{x} = -b'$ λ¥Ό ν’‰λ‹λ‹¤.
4.  **μƒνƒ μ—…λ°μ΄νΈ**: κ³„μ‚°λ $\Delta \mathbf{x}$ λ΅ ν¬μ¦λ¥Ό μ—…λ°μ΄νΈν•κ³ , μλ ΄ν•  λ•κΉμ§€ μ΄ κ³Όμ •μ„ λ°λ³µν•©λ‹λ‹¤.

μ΄ λ°©μ‹μ„ ν†µν•΄, μ΄μƒμΉλ΅ νλ‹¨λλ” μΈ΅μ •κ°’μ€ κ°€μ¤‘μΉκ°€ κ±°μ 0μ΄ λμ–΄ μµμ ν™” κ³Όμ •μ— κ±°μ μν–¥μ„ λ―ΈμΉμ§€ λ»ν•κ² λ©λ‹λ‹¤.

### [μ‹¤μµ μ—°κ²°]
`chapter06` λ…ΈνΈλ¶μ **4. Robust Pose Graph Optimizer** μ„Ήμ…μ—μ„λ”, Chapter 4μ—μ„ λ§λ“  μµν‹°λ§μ΄μ €μ— IRLS λ΅μ§μ„ μ¶”κ°€ν•μ—¬ μ΄μƒμΉμ— κ°•κ±΄ν• μµν‹°λ§μ΄μ €λ¥Ό μ§μ ‘ κµ¬ν„ν•κ³ , μ΄μƒμΉκ°€ ν¬ν•¨λ λ°μ΄ν„°μ…‹μ—μ„ L2μ™€ λ‹¤λ¥Έ μ»¤λ„λ“¤μ μ„±λ¥μ„ λΉ„κµν•μ—¬ κ·Έ ν¨κ³Όλ¥Ό κ·Ήμ μΌλ΅ ν™•μΈν•©λ‹λ‹¤.